<!--
 This file is part of the Open MIDATA Server.
 
 The Open MIDATA Server is free software: you can redistribute it and/or modify
 it under the terms of the GNU General Public License as published by
 the Free Software Foundation, either version 3 of the License, or
 any later version.
 
 The Open MIDATA Server is distributed in the hope that it will be useful,
 but WITHOUT ANY WARRANTY; without even the implied warranty of
 MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 GNU General Public License for more details.
 
 You should have received a copy of the GNU General Public License
 along with the Open MIDATA Server.  If not, see <http://www.gnu.org/licenses/>.
-->



<div ng-controller="OAuth2LoginCtrl" ng-cloak>

		<div class="mi-or-auth" ng-show="pleaseConfirm">
			<div class="mi-or-auth__content">

				<section class="mi-or-auth__section">
					<p class="mi-at-text mi-at-text--white mi-at-text--highlighted" translate="oauth2.please_confirm" translate-value-consent="{{ consent }}"></p>			
			    </section>
			</div>
		</div>

		<div class="mi-or-login welcome">
			<div class="mi-or-login__content">
			    
			
				<img src="/img/logo-midata--white.svg" alt="" class="mi-or-login__logo">

				<div ng-if="hasIcon()" class="mi-or-login__app_image" ng-style="getIconUrlBG()">
					
				</div>
                <div class="mi-or-login__instance"></div>
				<div class="mi-or-login__app">
					<span class="mi-at-text mi-at-text--smaller mi-at-text--white mi-at-text--highlighted">{{ app.i18n[translate.use()].name ||
						app.name }}</span> <span class="mi-at-text mi-at-text--smaller mi-at-text--white" translate="oauth2.requests_permission"></span>
				</div>

				
				
				<div class="mi-or-login__app" ng-hide="hideRegistration" style="margin-bottom: 0px">				
					<span class="mi-at-text mi-at-text--smaller mi-at-text--white"
						translate="oauth2.no_account" ng-click="showRegister(true);"></span>
						
					<button class="mi-mo-flat_button mi-mo-flat_button--rounded" type="button" ng-click="showRegister(true);">
					  <span class="mi-at-text" translate="oauth2.sign_up_btn"></span>					  
				    </button>					
				    
				    <div style="margin-top:20px"></div>
				    <div class="mi-at-text mi-at-text--smaller mi-at-text--white"
						translate="oauth2.have_account"></div>
					<div class="mi-at-text mi-at-text--smaller mi-at-text--white"
						translate="oauth2.have_account2"></div>
				</div>
				
				<form ng-submit="dologin()" role="form" ng-hide="offline" class="required">

					<fieldset class="mi-at-input__fieldset mi-at-input__fieldset--floating-label mi-at-input__fieldset--white">
						<input ng-disabled="studies" required id="mi-at-input-username" ng-model="login.email" class="mi-at-input mi-at-input--text"
							type="email" value="" floating-label /> <label for="mi-at-input-text" class="mi-at-text"
							translate="login.email_address"> username * </label>
					</fieldset>

					<fieldset class="mi-at-input__fieldset mi-at-input__fieldset--floating-label mi-at-input__fieldset--white">
						<input required id="mi-at-input-password" ng-disabled="studies" ng-model="login.password" class="mi-at-input mi-at-input--password"
							type="password" value="" floating-label /> <label for="mi-at-input-password" class="mi-at-text"
							translate="login.password"> password * </label>
					</fieldset>

					<fieldset class="mi-at-select__fieldset" ng-show="app.targetUserRole=='ANY'">
						<select id="account" name="account" ng-disabled="studies" ng-model="login.role"
							ng-options="role.value as role.name | translate for role in roles" class="mi-at-select mi-at-text mi-at-text--smaller" required>
						</select>
					</fieldset>

					<fieldset class="mi-at-select__fieldset" ng-show="studies">
						<select id="study" name="study" ng-model="login.studyLink" ng-options="study._id as study.name for study in studies"
							class="mi-at-select mi-at-text mi-at-text--smaller" required>
						</select>
					</fieldset>

                    <div class="mi-or-login__error" ng-show="error">
                       <span class="mi-at-text mi-at-text--smallest mi-at-text--white mi-at-text--highlighted"  translate="{{ error.code || error }}"></span>
                    </div>
                    <div class="mi-or-login__error" ng-show="offline">
                       <span class="mi-at-text mi-at-text--smallest mi-at-text--white mi-at-text--highlighted"  translate="error.offline"></span>
                    </div>

					<button class="mi-mo-flat_button mi-mo-flat_button--rounded" type="submit" ng-disabled="status.action=='login' || doneLock">
						<span class="mi-at-text" translate="oauth2.sign_in_btn">login</span>

					</button>

				</form>
				
			
				
				<div class="mi-or-login__signup_link" style="margin-top:-5px">				
					<span class="mi-at-text mi-at-text--smallest mi-at-text--white"
						translate="login.forgot_your_password" ng-click="lostpw();"></span>
						
										
				</div>
				
				
				
				
				<div class="mi-or-login__device">
					<span class="mi-at-text mi-at-text--smallest mi-at-text--white" translate="oauth2.device" translate-value-device="{{ device }}"></span>
				</div>
				<!-- <div class="mi-or-login__legal_mentions">
					<span class="mi-at-text mi-at-text--smallest mi-at-text--white">(c) 2018 ETH ZÃ¼rich</span>
				</div>  -->
			</div>
		</div>			

</div>
